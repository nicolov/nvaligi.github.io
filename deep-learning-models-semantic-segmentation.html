<!DOCTYPE html>
<html lang="en">

<head>
  <!-- ## for client-side less
  <link rel="stylesheet/less" type="text/css" href="//nicolovaligi.com/theme/css/style.less">
  <script src="http://cdnjs.cloudflare.com/ajax/libs/less.js/1.7.3/less.min.js" type="text/javascript"></script>
  -->
  <link rel="stylesheet" type="text/css" href="//nicolovaligi.com/theme/css/style.css">
  <link rel="stylesheet" type="text/css" href="//nicolovaligi.com/theme/css/pygments.css">
  <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=PT+Sans|PT+Serif|PT+Mono">
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">

  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="author" content="Nicolò Valigi">
  <meta name="description" content="Posts and writings by Nicolò Valigi">


<meta name="keywords" content="deep learning">

  <title>
A review of deep learning models for semantic segmentation -
    Nicolò Valigi
  </title>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-67820015-1', 'auto');
  ga('send', 'pageview');

</script></head>

<body>
  <aside>
    <div id="user_meta">
      <a href="//nicolovaligi.com">
        <img src="/blog/images/logo_white.jpg" alt="logo">
      </a>
      <h2><a href="//nicolovaligi.com">Nicolò Valigi</a></h2>
      <p>Software Engineer at Cruise Automation. I write about software and machine learning.</p>
      <ul class="links">
        <li><a href="/pages/robotics-for-developers-tutorial.html">Robotics for developers</a></li>
        <li><a href="/pages/research.html">Research</a></li>
      </ul>

      <ul style="padding-left: 0;
                 margin-left: -5px;
                 list-style: none;
                 text-align: center;">
        <li>
            <a href="https://github.com/nicolov">
                <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                </span>
            </a>
        </li>
        <li>
            <a href="mailto:nicolo.valigi@gmail.com">
                <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                </span>
            </a>
        </li>
    </ul>

    </div>
  </aside>

  <main>
    <header>
      <p>
      <a href="//nicolovaligi.com">Index</a> &nbsp; &brvbar; &nbsp;
      <a href="//nicolovaligi.com/tags.html">Tags</a> &nbsp; &brvbar; &nbsp;
      <a href="//nicolovaligi.com/archives.html">Archives</a>
      </p>
    </header>

<article>
  <div class="article_title">
    <h1><a href="//nicolovaligi.com/deep-learning-models-semantic-segmentation.html">A review of deep learning models for semantic segmentation</a></h1>
  </div>
  <div class="article_text">
    <p>This article is intended as an history and reference on the evolution of deep learning architectures for semantic segmentation of images. I am an Engineer, not a researcher, so the focus will be on performance and practical implementation considerations, rather than scientific novelty.</p>
<p>Semantic segmentation is a natural step-up from the more common task of <em>image classification</em>, and involves labeling <em>each pixel</em> of the input image. In practice, this ends up looking <a href="">like this</a>:</p>
<p><img alt="Deep learning for image segmentation" class="img-center" src="//nicolovaligi.com/example.png" style="max-width: 600px"/></p>
<p>The list below is mostly in chronological order, so that we can better follow the evolution of research in this field.</p>
<h2>Fully Convolutional Networks for Image Segmentation (2016)</h2>
<p><em>Long, J., Shelhamer, E., &amp; Darrell, T. (2015). Fully convolutional networks for semantic segmentation.</em></p>
<p>This is easily the most important work in Deep Learning for image segmentation, as it introduced many important ideas:</p>
<ul>
<li>end-to-end learning of the upsampling algorithm,</li>
<li>arbitrary input sizes thanks to the fully convolutional architecture,</li>
<li>pretraining on classification tasks,</li>
<li>skip connections for multi-scale inference.</li>
</ul>
<p>The first concept to understand is that fully-connected layers can be replaced with convolutions whose filter size equals the layer input dimension. As <a href="http://cs231n.github.io/convolutional-networks/#convert">explained in CS231n</a>, this equivalence enables the network to efficiently "sweep" over arbitrarily sized images while producing an output image, rather than a single vector as in classification.</p>
<p>While the output from a fully convolutional network could in principle directly be used for segmentation, it is usually the case that most network architectures downsample heavily to reduce the computational load. The paper introduces two ways to increase the resolution of the output.</p>
<p>The first approach has to do with <em>dilation</em>, and we're going to discuss it alongside the next paper. The second is usually called <em>deconvolution</em>, even if the community has been arguing for years about the proper name (is it <em>fractionally-strided convolution</em>, <em>backwards convolution</em>, <em>transposed convolution</em>?) Whatever the name, the core idea is to "reverse" a convolution operation to <em>increase</em>, rather than decrease, the resolution of the output. Since the convolution kernels will be learned during training, this is an effective way to recover the local information that was lost in the encoding phase.</p>
<p><img alt="Transposed convolution" class="img-center" src="//nicolovaligi.com/transposed_convolution.gif" style="max-width: 250px"/></p>
<p>Finally, this paper introduces <em>skip connections</em> as a way of fusing information from different depths in the network, that correspond to different image scales. The authors find that these connections add a lot of detail.</p>
<h2>DilatedNet (2016)</h2>
<p><em>Yu, F., &amp; Koltun, V. (2016). Multi-Scale Context Aggregation by Dilated Convolutions.</em></p>
<p>DilatedNet is a simple but powerful network that I enjoyed <a href="https://github.com/nicolov/segmentation_keras">porting to Keras</a>. The authors propose doing away with the "pyramidal" architecture carried over from classification tasks, and instead use <strong>dilated convolutions</strong> to avoid losing resolution altogether.</p>
<p><img alt="Dilated convolution" class="img-center" src="//nicolovaligi.com/dilated_convolution.gif" style="max-width: 250px"/></p>
<p>By using convolutional filters with "holes", the receptive field can grow exponentially while the number of parameters only grows linearly.</p>
<p>The frontend alone, based on VGG-16, outperforms DeepLab and FCN by replacing the last two pooling layers with dilated convolutions. Additionaly, the paper introduces a <strong>context module</strong>, a plug-and-play structure for multi-scale reasoning using a stack of dilated convolutions on a constant 21D feature map.</p>
<p>As reported in the appendix, this model also outperforms the state of the art in urban scene understanding benchmarks (CamVid, KITTI, and Cityscapes).</p>
<h2>The One Hundred Layer Tiramisu (2016)</h2>
<p><em>Jégou, S., Drozdzal, M., Vazquez, D., Romero, A., &amp; Bengio, Y. (2016). The One Hundred Layers Tiramisu: Fully Convolutional DenseNets for Semantic Segmentation.</em></p>
<p>This very recent paper (Dec 2016) develops a DenseNet-based segmentation network, achieving state-of-the-art performance with 100x less parameters than DilatedNet or FCN. In DenseNet networks, each layer is directly connected to all other layers. While these connections were originally introduced to allow training very deep networks, they're also a very good fit for segmentation thanks to the feature reuse enabled by these connections.</p>
<p>The authors use transposed convolution for the upsampling path, with an additional trick to avoid excessive computational load. The attached benchmarks show that the FC-DenseNet performs a bit better than DilatedNet on the CamVid dataset, without pre-training.</p>
<h2>Adversarial networks</h2>
<p><em>Luc, P., Couprie, C., &amp; Kuntzmann, L. J. (2016). Semantic Segmentation using Adversarial Networks.</em></p>
<p>Following the current excitement over the potential of Generative Adversarial Networks (GAN), the authors introduce an adversarial loss term to the standard segmentation FCN. The idea is that the discriminator would be able to use high-level information about the entire scene to assess the quality of the segmentation. In a sense, this acts as an high-order CRFs that's otherwise difficult to implement with conventional inference algorithms.</p>
<p>The segmentation side of the GAN was based on DilatedNet, and the results on Pascal VOC show a few percent points of improvement.</p>
<h2>Mentions</h2>
<h3>U-net (2015)</h3>
<p><em>Ronneberger, O., Fischer, P., &amp; Brox, T. (2015). U-Net: Convolutional Networks for Biomedical Image Segmentation.</em></p>
<p>Most of the networks we've seen operate either on ImageNet-style datasets (like Pascal VOC), or road scenes (like CamVid). U-Net is interesting because it applies an FCN architecture to <em>biomedical</em> images, and presents an hardcore augmentation workflow to make the most out of the limited data available in that field.</p>
<h3>Segnet (2015)</h3>
<p><em>Badrinarayanan, V., Kendall, A., &amp; Cipolla, R. (2015). SegNet: A Deep Convolutional Encoder-Decoder Architecture for Image Segmentation. Cvpr 2015.</em></p>
<p>While the ArXiv preprint came out at about the same time as the FCN paper, this CVPR 2015 version includes thorough comparisons with FCN. It contains an interesting discussion of different upsampling techniques, and discusses a modification to FCN's that can reduce inference memory 10x with a loss in accuracy.</p>
<h2>Conclusions</h2>
<p>Not unlike classification, a lot of manpower in segmentation has been spent in optimizing post-processing algorithms to squeeze out a few more percentage points in the benchmark. For this reason, I believe that a simple network like DilatedNet is currently the best suited for real-life implementation, and would be a good base to build custom post-processing pipelines. You can try out my <a href="https://github.com/nicolov/segmentation_keras">Keras implementation</a>.</p>
<p><em>All images are reproduced from the corresponding papers. Animations are from <a href="https://github.com/vdumoulin/conv_arithmetic">here</a>.</em></p>
  </div>
  <div class="article_meta">
    <p>Posted on: Sat 10 December 2016</p>
    <p>Category: <a href="//nicolovaligi.com/category/2016-12-10-segmentation-models.html">2016-12-10-segmentation models</a>
 &ndash; Tags:
      <a href="//nicolovaligi.com/tag/deep-learning.html">deep learning</a>    </p>
  </div>


</article>


    <div id="ending_message">
      <p>&copy; Nicolò Valigi. Built using <a href="http://getpelican.com" target="_blank">Pelican</a>. Theme originally by Giulio Fidente on <a href="https://github.com/gfidente/pelican-svbhack" target="_blank">github</a>. </p>
    </div>
  </main>
</body>
</html>