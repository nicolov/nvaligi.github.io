<!DOCTYPE html>
<html lang="en">

<head>
  <!-- ## for client-side less
  <link rel="stylesheet/less" type="text/css" href="//nicolovaligi.com/theme/css/style.less">
  <script src="http://cdnjs.cloudflare.com/ajax/libs/less.js/1.7.3/less.min.js" type="text/javascript"></script>
  -->
  <link rel="stylesheet" type="text/css" href="//nicolovaligi.com/theme/css/style.css">
  <link rel="stylesheet" type="text/css" href="//nicolovaligi.com/theme/css/pygments.css">
  <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=PT+Sans|PT+Serif|PT+Mono">
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">

  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="author" content="Nicolò Valigi">
  <meta name="description" content="Posts and writings by Nicolò Valigi">


<meta name="keywords" content="deep learning, robotics">

  <title>
How can Deep Learning help Robotics and SLAM -
    Nicolò Valigi
  </title>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-67820015-1', 'auto');
  ga('send', 'pageview');

</script></head>

<body>
  <aside>
    <div id="user_meta">
      <a href="//nicolovaligi.com">
        <img src="/blog/images/logo_white.jpg" alt="logo">
      </a>
      <h2><a href="//nicolovaligi.com">Nicolò Valigi</a></h2>
      <p>Software Engineer at Cruise Automation. I write about software and machine learning.</p>
      <ul class="links">
        <li><a href="/pages/robotics-for-developers-tutorial.html">Robotics for developers</a></li>
        <li><a href="/pages/research.html">Research</a></li>
      </ul>

      <ul style="padding-left: 0;
                 margin-left: -5px;
                 list-style: none;
                 text-align: center;">
        <li>
            <a href="https://github.com/nicolov">
                <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                </span>
            </a>
        </li>
        <li>
            <a href="mailto:nicolo.valigi@gmail.com">
                <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                </span>
            </a>
        </li>
    </ul>

    </div>
  </aside>

  <main>
    <header>
      <p>
      <a href="//nicolovaligi.com">Index</a> &nbsp; &brvbar; &nbsp;
      <a href="//nicolovaligi.com/tags.html">Tags</a> &nbsp; &brvbar; &nbsp;
      <a href="//nicolovaligi.com/archives.html">Archives</a>
      </p>
    </header>

<article>
  <div class="article_title">
    <h1><a href="//nicolovaligi.com/deep-learning-robotics-slam.html">How can Deep Learning help Robotics and SLAM</a></h1>
  </div>
  <div class="article_text">
    <p>By now, Deep Learning needs no introduction for most people in the tech community. Powered by massively parallel GPUs and hundreds of research teams around the world, neural networks have taken the machine learning community by storm in the last few years. Convolutional networks have won <a href="https://en.wikipedia.org/wiki/ImageNet">image classification competitions</a> since 2010, <a href="https://www.tensorflow.org/versions/r0.10/tutorials/recurrent/index.html">recurrent networks</a> are incredible at modeling and understanding human language, and deep nets can even <a href="https://deepmind.com/blog/wavenet-generative-model-raw-audio/">compose music</a> after listening to Mozart for a while.</p>
<p>Applications of Deep Learning (DL) to autonomous robots are still not as widespread as these more well-known problems listed above. In this article, I'm going to focus on one such area and review the literature on Deep Learning as applied to a crucial problem in perception: Simultaneous Localization and Mapping (SLAM).</p>
<h2>State of the (SLAM) art</h2>
<p>A majority of SLAM systems share several common components:</p>
<ul>
<li>a <strong>feature detector</strong> that finds point of interest within the image (<em>features</em>),</li>
<li>a <strong>feature descriptor</strong> that matches tracks features from one image to the next,</li>
<li>an <strong>optimization</strong> backend that uses said correspondences to build a geometry of the scene (map) and find the position of the robot,</li>
<li>a <strong>loop closure detection</strong> algorithm that recognizes previously visited areas and adds constraints to the map.</li>
</ul>
<p>Due to its similarities to well-studied image classification and retrieval problems, <em>loop closure</em> has the most potential to be solved with DL techniques. It's also an important issue, as correct loop closures guarantee the consistency of the SLAM map and improve all-around accuracy. Computational efficiency and robustness to false positives are the most important characteristics of a successful loop closure subsystem.</p>
<p><a href="http://webdiis.unizar.es/~raulmur/orbslam/">ORB-SLAM</a> is arguably the most advanced open-source package for visual SLAM. The crucial insight that enables real-time performance is using the same ORB descriptor (<a href='#Rublee2011' id='ref-Rublee2011-1'>Rublee and Bradski (2011)</a>) for both frame-to-frame tracking and loop closure detection. To go from individual features to a global description of the image, ORB uses another common technique, a <strong>bag of words (BoW)</strong> representation.</p>
<blockquote>
<p>In other words, conventional methods use <em>non-learned</em> feature descriptors and bundle them together using yet another <em>non-learned</em> algorithm (BoW-like).</p>
</blockquote>
<p>Following the same line of reasoning that worked so well for image classification, one could anticipate that <em>learned</em> features could be more effective that hand-engineering specific algorithms. That's exactly where the power of deep learning lies: developing better representations for the image data, which is just another form of the heavy-handed compression we need for fast loop closure detection.</p>
<p>The next two sections will be a long-form literature review of some approaches in this field.</p>
<h2>A straightforward approach</h2>
<p>While the superior accuracy of CNN-based descriptors for <strong>classification</strong> is a well-known fact by now, <a href='#Fischer2014' id='ref-Fischer2014-1'>Fischer et al. (2014)</a> prove that CNNs outperform SIFT even on the matching tasks required for SLAM.</p>
<p>It is thus natural to try to extend this approach from single features to whole-image descriptors as commonly implemented through BoW. In fact, this is exactly the investigation carried out by <a href='#Hou2015' id='ref-Hou2015-1'>Hou et al. (2015)</a>, who started out with a pre-trained Caffe model (AlexNet on the Places dataset). The compressed representation of the input image is obtained by pulling data out of the CNN at various layers during the <em>forward pass</em>.</p>
<p>This is a very simple operation, almost an "afterthought" in the operation of the network, but still allows quite a bit of flexibility. By comparing representations extracted at different layers, they find that the last pooling layer, just before the final fully connected layers, performs the best.</p>
<p>While the precision/recall tradeoff is comparable to hand-crafted features, CNNs are 1-2 order of magnitude faster to compute.</p>
<p><a href='#Chen2013' id='ref-Chen2013-1'>Chen et al. (2013)</a> have also worked along the same lines, by leveraging the representations embedded in an existing CNN.</p>
<h2>End-to-end learning for place recognition</h2>
<p>Another interesting work is by <a href='#Arandjelovic2015' id='ref-Arandjelovic2015-1'>Arandjelovic et al. (2015)</a>, who went with a fully end-to-end learning approach customized for place recognition.</p>
<blockquote>
<p><a href='#Hou2015' id='ref-Hou2015-2'>Hou et al. (2015)</a> implement loop closure by piggy-backing on an existing network that was trained using a loss-fuction developed for image classification. The obvious question is whether a network architected and trained for the express purpose of image retrieval can do any better.</p>
</blockquote>
<p>The original contribution in this paper is the <em>NetVLAD</em> layer, an aggregation layer trained alongside the main network. The NetVLAD layer simulates the VLAD algorithm for the aggregation of feature descriptors described in <a href='#Jegou2010' id='ref-Jegou2010-1'>Jegou et al. (2010)</a>, which is an alternative to BoW-style aggregation. Coupling this old and proven idea with end-to-end learning is one of the main contributions of the paper. To train this network, the authors introduce a <em>weakly-supervised</em> loss function based on the (rough) GPS locations available in the Google Street View images used for training.</p>
<p>The authors then show how their network + loss function combination performs better than pre-trained models borrowed from object classification tasks. It seems that the weak supervision is enough to steer the network towards focusing on stable and efficient descriptors.</p>
<h2>Lessons learned</h2>
<ol>
<li>
<p>Training on a scene-heavy dataset, such as Places by MIT CSAIL, or the Google Street View dataset, improves place recognition performance quite a bit compared to object-heavy sets.</p>
</li>
<li>
<p>End-to-end training for place recognition handily beats using pre-trained models focused on classification. It seems that medium-depth representation are quite important here.</p>
</li>
<li>
<p>A feed-forward pass through a CNN is much faster than using hand-engineered features, even on a CPU. Interesting speedups for existing SLAM systems seems within easy reach, with the caveat that they need both feature-level and image-level descriptors at the same time.</p>
</li>
</ol>
<h2>Other useful code &amp; references</h2>
<ul>
<li>an implementation of the VLAD algorithm for hand-engineered features (<a href="https://github.com/ameya005/VLAD-Implementation">github</a>)</li>
<li>the implementation of BoW (<a href="https://github.com/dorian3d/DBoW2">github</a>) used in ORB-SLAM</li>
<li><em>scene recognition</em> is the classification of image <em>context</em>. <a href='#Zhou2014' id='ref-Zhou2014-1'>Zhou et al. (2014)</a> introduce a new dataset that improves performance on such task, compared to conventional object-focused image collections. Training loop-closure networks on this dataset yields better performance that</li>
</ul><hr>
<h2>Bibliography</h2>
<p id='Arandjelovic2015'>Relja Arandjelović, Petr Gronat, Akihiko Torii, Tomas Pajdla, and Josef Sivic.
NetVLAD: CNN architecture for weakly supervised place recognition.
<em>Arxiv</em>, 2015.
URL: <a href="http://arxiv.org/abs/1511.07247">http://arxiv.org/abs/1511.07247</a>, <a href="http://arxiv.org/abs/1511.07247">arXiv:1511.07247</a>, <a href="http://dx.doi.org/10.1109/CVPR.2016.572">doi:10.1109/CVPR.2016.572</a>. <a class="cite-backref" href="#ref-Arandjelovic2015-1" title="Jump back to reference 1">↩</a></p>
<p id='Chen2013'>Zetao Chen, Obadiah Lam, Adam Jacobson, and Michael Milford.
Convolutional Neural Network-based Place Recognition.
<em>2014 Australasian Conference on Robotics and Automation (ACRA 2014)</em>, pages 8, 2013.
<a href="http://arxiv.org/abs/1411.1509">arXiv:1411.1509</a>. <a class="cite-backref" href="#ref-Chen2013-1" title="Jump back to reference 1">↩</a></p>
<p id='Fischer2014'>Philipp Fischer, Alexey Dosovitskiy, and Thomas Brox.
Descriptor Matching with Convolutional Neural Networks: a Comparison to SIFT.
<em>arXiv</em>, pages 1–10, 2014.
URL: <a href="http://arxiv.org/abs/1405.5769">http://arxiv.org/abs/1405.5769</a>, <a href="http://arxiv.org/abs/1405.5769">arXiv:1405.5769</a>. <a class="cite-backref" href="#ref-Fischer2014-1" title="Jump back to reference 1">↩</a></p>
<p id='Hou2015'>Yi&nbsp;Hou, Hong Zhang, and Shilin Zhou.
Convolutional Neural Network-Based Image Representation for Visual Loop Closure Detection.
pages 2238–2245, 2015.
<a href="http://arxiv.org/abs/1504.05241">arXiv:1504.05241</a>. <a class="cite-backref" href="#ref-Hou2015-1" title="Jump back to reference 1">↩</a><a class="cite-backref" href="#ref-Hou2015-1" title="Jump back to reference 1"> <sup>1</sup> </a><a class="cite-backref" href="#ref-Hou2015-2" title="Jump back to reference 2"><sup>2</sup> </a></p>
<p id='Jegou2010'>Hervé Jégou, Matthijs Douze, Cordelia Schmid, and Patrick Pérez.
Aggregating local descriptors into a compact image representation.
<em>Proceedings of the IEEE Computer Society Conference on Computer Vision and Pattern Recognition</em>, pages 3304–3311, 2010.
<a href="http://dx.doi.org/10.1109/CVPR.2010.5540039">doi:10.1109/CVPR.2010.5540039</a>. <a class="cite-backref" href="#ref-Jegou2010-1" title="Jump back to reference 1">↩</a></p>
<p id='Rublee2011'>Ethan Rublee and Gary Bradski.
ORB - an efficient alternative to SIFT or SURF.
2011.
URL: <a href="http://www.willowgarage.com/sites/default/files/orb_final.pdf">http://www.willowgarage.com/sites/default/files/orb_final.pdf</a>, <a href="http://dx.doi.org/10.1109/ICCV.2011.6126544">doi:10.1109/ICCV.2011.6126544</a>. <a class="cite-backref" href="#ref-Rublee2011-1" title="Jump back to reference 1">↩</a></p>
<p id='Zhou2014'>Bolei Zhou, Agata Lapedriza, Jianxiong Xiao, Antonio Torralba, and Aude Oliva.
Learning Deep Features for Scene Recognition using Places Database.
<em>Advances in Neural Information Processing Systems 27</em>, pages 487–495, 2014.
URL: <a href="http://papers.nips.cc/paper/5349-learning-deep-features-for-scene-recognition-using-places-database.pdf">http://papers.nips.cc/paper/5349-learning-deep-features-for-scene-recognition-using-places-database.pdf</a>. <a class="cite-backref" href="#ref-Zhou2014-1" title="Jump back to reference 1">↩</a></p>

  </div>
  <div class="article_meta">
    <p>Posted on: Thu 15 September 2016</p>
    <p>Category: <a href="//nicolovaligi.com/category/2016.html">2016</a>
 &ndash; Tags:
      <a href="//nicolovaligi.com/tag/deep-learning.html">deep learning</a>,      <a href="//nicolovaligi.com/tag/robotics.html">robotics</a>    </p>
  </div>


</article>


    <div id="ending_message">
      <p>&copy; Nicolò Valigi. Built using <a href="http://getpelican.com" target="_blank">Pelican</a>. Theme originally by Giulio Fidente on <a href="https://github.com/gfidente/pelican-svbhack" target="_blank">github</a>. </p>
    </div>
  </main>
</body>
</html>